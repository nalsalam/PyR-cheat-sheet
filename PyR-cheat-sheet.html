<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>pandas - dplyr equivalents</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="PyR-cheat-sheet_files/libs/clipboard/clipboard.min.js"></script>
<script src="PyR-cheat-sheet_files/libs/quarto-html/quarto.js"></script>
<script src="PyR-cheat-sheet_files/libs/quarto-html/popper.min.js"></script>
<script src="PyR-cheat-sheet_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="PyR-cheat-sheet_files/libs/quarto-html/anchor.min.js"></script>
<link href="PyR-cheat-sheet_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="PyR-cheat-sheet_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="PyR-cheat-sheet_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="PyR-cheat-sheet_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="PyR-cheat-sheet_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#selecting-columns" id="toc-selecting-columns" class="nav-link active" data-scroll-target="#selecting-columns">Selecting columns</a></li>
  <li><a href="#renaming-a-single-column" id="toc-renaming-a-single-column" class="nav-link" data-scroll-target="#renaming-a-single-column">Renaming a single column</a></li>
  <li><a href="#renaming-multiple-columns-based-on-condition" id="toc-renaming-multiple-columns-based-on-condition" class="nav-link" data-scroll-target="#renaming-multiple-columns-based-on-condition">Renaming multiple columns based on condition</a></li>
  <li><a href="#distinct-values-in-a-column" id="toc-distinct-values-in-a-column" class="nav-link" data-scroll-target="#distinct-values-in-a-column">distinct values in a column</a></li>
  <li><a href="#count-records-by-a-categorical-variable" id="toc-count-records-by-a-categorical-variable" class="nav-link" data-scroll-target="#count-records-by-a-categorical-variable">count records by a categorical variable</a></li>
  <li><a href="#summarize-aggregate-over-entire-columns" id="toc-summarize-aggregate-over-entire-columns" class="nav-link" data-scroll-target="#summarize-aggregate-over-entire-columns">summarize / aggregate over entire column(s)</a></li>
  <li><a href="#summarize-aggregate-by-group" id="toc-summarize-aggregate-by-group" class="nav-link" data-scroll-target="#summarize-aggregate-by-group">summarize / aggregate by group</a></li>
  <li><a href="#column-math-adding-a-new-column" id="toc-column-math-adding-a-new-column" class="nav-link" data-scroll-target="#column-math-adding-a-new-column">column math / adding a new column</a></li>
  <li><a href="#deleting-columns" id="toc-deleting-columns" class="nav-link" data-scroll-target="#deleting-columns">deleting columns</a></li>
  <li><a href="#changing-order-of-columns" id="toc-changing-order-of-columns" class="nav-link" data-scroll-target="#changing-order-of-columns">changing order of columns</a></li>
  <li><a href="#slicing" id="toc-slicing" class="nav-link" data-scroll-target="#slicing">slicing</a></li>
  <li><a href="#slicing-first-and-last-records-head-tail" id="toc-slicing-first-and-last-records-head-tail" class="nav-link" data-scroll-target="#slicing-first-and-last-records-head-tail">Slicing first and last records (head / tail)</a></li>
  <li><a href="#creating-boolean-vectorseries" id="toc-creating-boolean-vectorseries" class="nav-link" data-scroll-target="#creating-boolean-vectorseries">creating boolean vector/series</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">pandas - dplyr equivalents</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>This “cheat sheet” is for people who know pandas and want to learn the dplyr equivalent or vice versa.</p>
<p>Thanks to <a href="https://towardsdatascience.com/python-pandas-vs-r-dplyr-5b5081945ccb">Martin Siklar</a> for getting this started. I have and will continue to add to this.</p>
<p>It takes too long to puzzle out how to do something in your non-dominant language, so I’m hoping we can crowd source the equivalents and save time learning.</p>
<p>I am in the know-dplyr learning pandas group. If there is a common pandas task you are interested in knowing how to do with dplyr, please share the pandas code with me. If there is a better or another way to do a certain task in pandas, please share that code with me.</p>
<p>Use the table of contents to jump to a task.</p>
<p>This “cheat sheet” produced using the Quarto approach to mixing code and text. Quarto supports both python and R in the same document. I rendered it in Rstudo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>-- Attaching packages --------------------------------------- tidyverse 1.3.2 --
v ggplot2 3.3.6     v purrr   1.0.1
v tibble  3.2.1     v dplyr   1.1.0
v tidyr   1.2.1     v stringr 1.5.0
v readr   2.1.4     v forcats 0.5.2
-- Conflicts ------------------------------------------ tidyverse_conflicts() --
x dplyr::filter() masks stats::filter()
x dplyr::lag()    masks stats::lag()</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># https://rstudio.github.io/reticulate/articles/versions.html</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># https://cran.r-project.org/web/packages/reticulate/vignettes/python_packages.html</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">use_python</span>(<span class="st">"c:/users/nabee/anaconda3/python.exe"</span>) <span class="co"># has pandas</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># use_condaenv(condaenv = "py4ds",</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#             conda = "C:/Users/nabee/anaconda3/condabin/conda")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> palmerpenguins <span class="im">import</span> load_penguins</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>iris <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"data/iris.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 150 Columns: 5
-- Column specification --------------------------------------------------------
Delimiter: ","
chr (1): Species
dbl (4): Sepal.Length, Sepal.Width, Petal.Length, Petal.Width

i Use `spec()` to retrieve the full column specification for this data.
i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 150
Columns: 5
$ Sepal.Length &lt;dbl&gt; 5.1, 4.9, 4.7, 4.6, 5.0, 5.4, 4.6, 5.0, 4.4, 4.9, 5.4, 4.~
$ Sepal.Width  &lt;dbl&gt; 3.5, 3.0, 3.2, 3.1, 3.6, 3.9, 3.4, 3.4, 2.9, 3.1, 3.7, 3.~
$ Petal.Length &lt;dbl&gt; 1.4, 1.4, 1.3, 1.5, 1.4, 1.7, 1.4, 1.5, 1.4, 1.5, 1.5, 1.~
$ Petal.Width  &lt;dbl&gt; 0.2, 0.2, 0.2, 0.2, 0.2, 0.4, 0.3, 0.2, 0.2, 0.1, 0.2, 0.~
$ Species      &lt;chr&gt; "setosa", "setosa", "setosa", "setosa", "setosa", "setosa~</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>mpg <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"data/mpg.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 234 Columns: 11
-- Column specification --------------------------------------------------------
Delimiter: ","
chr (6): manufacturer, model, trans, drv, fl, class
dbl (5): displ, year, cyl, cty, hwy

i Use `spec()` to retrieve the full column specification for this data.
i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>economics <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"data/economics.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 574 Columns: 6
-- Column specification --------------------------------------------------------
Delimiter: ","
dbl  (5): pce, pop, psavert, uempmed, unemploy
date (1): date

i Use `spec()` to retrieve the full column specification for this data.
i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>cps_samples <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"data/cps_samples.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 625 Columns: 2
-- Column specification --------------------------------------------------------
Delimiter: ","
chr (2): sample_id, description

i Use `spec()` to retrieve the full column specification for this data.
i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>Bring <code>iris</code> from R and edit variable names.</p>
<p>A big difference between Python and R is that Python methods often “modify in place” whereas R functions always “copy on modify”. For that reason and for the purpose of this tutorial, at the end of Python code chunks that have modified <code>iris</code> dataframe the original <code>iris</code> dataframe is restored.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># edit variable names to match what how they are in Python</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>iris <span class="ot">&lt;-</span> iris <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="at">.fn =</span> <span class="sc">~</span> <span class="fu">str_replace</span>(.x, <span class="st">"</span><span class="sc">\\</span><span class="st">."</span>, <span class="st">"_"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="at">.fn =</span> <span class="sc">~</span> <span class="fu">str_replace</span>(.x, <span class="st">"W"</span>, <span class="st">"w"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="at">.fn =</span> <span class="sc">~</span> <span class="fu">str_replace</span>(.x, <span class="st">"L"</span>, <span class="st">"l"</span>))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(iris)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 150
Columns: 5
$ Sepal_length &lt;dbl&gt; 5.1, 4.9, 4.7, 4.6, 5.0, 5.4, 4.6, 5.0, 4.4, 4.9, 5.4, 4.~
$ Sepal_width  &lt;dbl&gt; 3.5, 3.0, 3.2, 3.1, 3.6, 3.9, 3.4, 3.4, 2.9, 3.1, 3.7, 3.~
$ Petal_length &lt;dbl&gt; 1.4, 1.4, 1.3, 1.5, 1.4, 1.7, 1.4, 1.5, 1.4, 1.5, 1.5, 1.~
$ Petal_width  &lt;dbl&gt; 0.2, 0.2, 0.2, 0.2, 0.2, 0.4, 0.3, 0.2, 0.2, 0.1, 0.2, 0.~
$ Species      &lt;chr&gt; "setosa", "setosa", "setosa", "setosa", "setosa", "setosa~</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>iris <span class="op">=</span> r.iris</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>mpg <span class="op">=</span> r.mpg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="selecting-columns" class="level1">
<h1>Selecting columns</h1>
<p>And here it already gets confusing. First of all, there are multiple ways on how to select columns from a dataframe in each framework. In pandas you can either simply pass a list with the column names or use the filter() method. This is confusing because the filter() function in dplyr is used to subset rows based on conditions and not columns! In dplyr we use the select() function instead:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Use Filter Function</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>iris.<span class="bu">filter</span>(items<span class="op">=</span>[<span class="st">'Sepal_width'</span>, <span class="st">'Petal_width'</span>])</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Use Filter Function</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Sepal_width  Petal_width
0            3.5          0.2
1            3.0          0.2
2            3.2          0.2
3            3.1          0.2
4            3.6          0.2
..           ...          ...
145          3.0          2.3
146          2.5          1.9
147          3.0          2.0
148          3.4          2.3
149          3.0          1.8

[150 rows x 2 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>iris.<span class="bu">filter</span>(items<span class="op">=</span>[<span class="st">'Sepal_width'</span>, <span class="st">'Petal_width'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Sepal_width  Petal_width
0            3.5          0.2
1            3.0          0.2
2            3.2          0.2
3            3.1          0.2
4            3.6          0.2
..           ...          ...
145          3.0          2.3
146          2.5          1.9
147          3.0          2.0
148          3.4          2.3
149          3.0          1.8

[150 rows x 2 columns]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Pass columns as list</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> <span class="fu">select</span>(Sepal_width, Petal_width) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 x 2
  Sepal_width Petal_width
        &lt;dbl&gt;       &lt;dbl&gt;
1         3.5         0.2
2         3           0.2
3         3.2         0.2
4         3.1         0.2
5         3.6         0.2
6         3.9         0.4</code></pre>
</div>
</div>
<p>Filter based on conditions Again, there are multiple ways on how to filter records in a dataframe based on conditions across one or multiple columns.</p>
<p>pandas</p>
<p>In pandas you can either use the indexing approach or try out the handy query API, which I personally prefer.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#indexing</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>iris[(iris[<span class="st">"Sepal_width"</span>] <span class="op">&gt;</span> <span class="fl">3.5</span>) <span class="op">&amp;</span> (iris[<span class="st">"Petal_width"</span>] <span class="op">&lt;</span> <span class="fl">0.3</span>)]</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co">#query API</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Sepal_length  Sepal_width  Petal_length  Petal_width Species
4            5.0          3.6           1.4          0.2  setosa
10           5.4          3.7           1.5          0.2  setosa
14           5.8          4.0           1.2          0.2  setosa
22           4.6          3.6           1.0          0.2  setosa
32           5.2          4.1           1.5          0.1  setosa
33           5.5          4.2           1.4          0.2  setosa
37           4.9          3.6           1.4          0.1  setosa
46           5.1          3.8           1.6          0.2  setosa
48           5.3          3.7           1.5          0.2  setosa</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>iris.query(<span class="st">"Sepal_width &gt; 3.5 &amp; Petal_width &lt; 0.3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Sepal_length  Sepal_width  Petal_length  Petal_width Species
4            5.0          3.6           1.4          0.2  setosa
10           5.4          3.7           1.5          0.2  setosa
14           5.8          4.0           1.2          0.2  setosa
22           4.6          3.6           1.0          0.2  setosa
32           5.2          4.1           1.5          0.1  setosa
33           5.5          4.2           1.4          0.2  setosa
37           4.9          3.6           1.4          0.1  setosa
46           5.1          3.8           1.6          0.2  setosa
48           5.3          3.7           1.5          0.2  setosa</code></pre>
</div>
</div>
<p>dplyr</p>
<p>The standard way of filtering records in dplyr is via the filter function().</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Sepal_width <span class="sc">&gt;</span> <span class="fl">3.5</span> <span class="sc">&amp;</span> Petal_width <span class="sc">&lt;</span> <span class="fl">0.3</span>) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 x 5
  Sepal_length Sepal_width Petal_length Petal_width Species
         &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;  
1          5           3.6          1.4         0.2 setosa 
2          5.4         3.7          1.5         0.2 setosa 
3          5.8         4            1.2         0.2 setosa 
4          4.6         3.6          1           0.2 setosa 
5          5.2         4.1          1.5         0.1 setosa 
6          5.5         4.2          1.4         0.2 setosa </code></pre>
</div>
</div>
</section>
<section id="renaming-a-single-column" class="level1">
<h1>Renaming a single column</h1>
<p>Renaming sounds like an easy task, but be cautious and note the subtle difference here. If we want to rename our column from Species to Class in pandas we supply a dictionary that says {‘Species’: ‘Class’} and in dplyr it is the exact opposite way Class=Species:</p>
<p>pandas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># {oldname : newname}</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>iris.rename(columns <span class="op">=</span> {<span class="st">'Species'</span>: <span class="st">'Class'</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>iris <span class="op">=</span> r.iris <span class="co"># restore original</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>dplyr</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># newname = oldname</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">Class=</span>Species) <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 150
Columns: 5
$ Sepal_length &lt;dbl&gt; 5.1, 4.9, 4.7, 4.6, 5.0, 5.4, 4.6, 5.0, 4.4, 4.9, 5.4, 4.~
$ Sepal_width  &lt;dbl&gt; 3.5, 3.0, 3.2, 3.1, 3.6, 3.9, 3.4, 3.4, 2.9, 3.1, 3.7, 3.~
$ Petal_length &lt;dbl&gt; 1.4, 1.4, 1.3, 1.5, 1.4, 1.7, 1.4, 1.5, 1.4, 1.5, 1.5, 1.~
$ Petal_width  &lt;dbl&gt; 0.2, 0.2, 0.2, 0.2, 0.2, 0.4, 0.3, 0.2, 0.2, 0.1, 0.2, 0.~
$ Class        &lt;chr&gt; "setosa", "setosa", "setosa", "setosa", "setosa", "setosa~</code></pre>
</div>
</div>
</section>
<section id="renaming-multiple-columns-based-on-condition" class="level1">
<h1>Renaming multiple columns based on condition</h1>
<p>Let us say we want to rename multiple columns at once based on a condition. For example, convert all our feature columns (Sepal_length, Sepal_width, Petal_length, Petal_width) to upper case. In Python that’s actually quite tricky and you need to first import another library and iterate manually over each column. In dplyr there is a much cleaner interface if you want to access/change multiple columns based on conditions.</p>
<p>pandas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re <span class="co"># regular expressions</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co">#prepare pattern that columns have to match to be converted to upper case</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>pattern <span class="op">=</span> re.<span class="bu">compile</span>(<span class="vs">r".*(length|width)"</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co">#iterate over columns and covert to upper case if pattern matches.</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> iris.columns:</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="bu">bool</span>((pattern.match(col))):</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    iris.rename(columns <span class="op">=</span> {col: col.upper()}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>iris.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       SEPAL_LENGTH  SEPAL_WIDTH  PETAL_LENGTH  PETAL_WIDTH
count    150.000000   150.000000    150.000000   150.000000
mean       5.843333     3.057333      3.758000     1.199333
std        0.828066     0.435866      1.765298     0.762238
min        4.300000     2.000000      1.000000     0.100000
25%        5.100000     2.800000      1.600000     0.300000
50%        5.800000     3.000000      4.350000     1.300000
75%        6.400000     3.300000      5.100000     1.800000
max        7.900000     4.400000      6.900000     2.500000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>iris <span class="op">=</span> r.iris <span class="co"># restore original</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>dplyr</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> <span class="fu">rename_with</span>(toupper, <span class="fu">matches</span>(<span class="st">"length|width"</span>)) <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 150
Columns: 5
$ SEPAL_LENGTH &lt;dbl&gt; 5.1, 4.9, 4.7, 4.6, 5.0, 5.4, 4.6, 5.0, 4.4, 4.9, 5.4, 4.~
$ SEPAL_WIDTH  &lt;dbl&gt; 3.5, 3.0, 3.2, 3.1, 3.6, 3.9, 3.4, 3.4, 2.9, 3.1, 3.7, 3.~
$ PETAL_LENGTH &lt;dbl&gt; 1.4, 1.4, 1.3, 1.5, 1.4, 1.7, 1.4, 1.5, 1.4, 1.5, 1.5, 1.~
$ PETAL_WIDTH  &lt;dbl&gt; 0.2, 0.2, 0.2, 0.2, 0.2, 0.4, 0.3, 0.2, 0.2, 0.1, 0.2, 0.~
$ Species      &lt;chr&gt; "setosa", "setosa", "setosa", "setosa", "setosa", "setosa~</code></pre>
</div>
</div>
<p>Note the upper case feature column names.</p>
<p>Altering cell values based on conditions</p>
<p>Let us say we want to recode/alter cell values based on conditions: In our example, we will try to recode the Species strings “setosa, versicolor and virginica” to integers from 0 to 2:</p>
<p>pandas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Error</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>iris.loc[iris[<span class="st">'Species'</span>] <span class="op">==</span> <span class="st">'setosa'</span>, <span class="st">"Species"</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>iris.loc[iris[<span class="st">'Species'</span>] <span class="op">==</span> <span class="st">'versicolor'</span>, <span class="st">"Species"</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>iris.loc[iris[<span class="st">'Species'</span>] <span class="op">==</span> <span class="st">'virginica'</span>, <span class="st">"Species"</span>] <span class="op">=</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>dplyr</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species =</span> <span class="fu">case_when</span>(Species <span class="sc">==</span> <span class="st">'setosa'</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                             Species <span class="sc">==</span> <span class="st">'versicolor'</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>                             Species <span class="sc">==</span> <span class="st">'virginica'</span> <span class="sc">~</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 x 5
  Sepal_length Sepal_width Petal_length Petal_width Species
         &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;
1          5.1         3.5          1.4         0.2       0
2          4.9         3            1.4         0.2       0
3          4.7         3.2          1.3         0.2       0
4          4.6         3.1          1.5         0.2       0
5          5           3.6          1.4         0.2       0
6          5.4         3.9          1.7         0.4       0</code></pre>
</div>
</div>
</section>
<section id="distinct-values-in-a-column" class="level1">
<h1>distinct values in a column</h1>
<p>Sometimes we want to see which values distinct/unique values we have in a column. Note how different the function call is in both frameworks: pandas uses the unique() method and dplyr() uses the distinct() function to get to the same result:</p>
<p>pandas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>iris.Species.unique()</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co">#array(['setosa', 'versicolor', 'virginica'], dtype=object)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>array(['setosa', 'versicolor', 'virginica'], dtype=object)</code></pre>
</div>
</div>
<p>dplyr</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> <span class="fu">select</span>(Species) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> <span class="fu">count</span>(Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 x 2
  Species        n
  &lt;chr&gt;      &lt;int&gt;
1 setosa         1
2 versicolor     1
3 virginica      1</code></pre>
</div>
</div>
</section>
<section id="count-records-by-a-categorical-variable" class="level1">
<h1>count records by a categorical variable</h1>
<p>If you want to count how many entries the iris dataframe has in total or get a count for a certain group, you can do the following:</p>
<p>pandas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>150</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>iris.value_counts(<span class="st">'Species'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Species
setosa        50
versicolor    50
virginica     50
dtype: int64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>iris.groupby([<span class="st">'Species'</span>]).size()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Species
setosa        50
versicolor    50
virginica     50
dtype: int64</code></pre>
</div>
</div>
<p>dplyr</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 150</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span> <span class="fu">tally</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 x 2
  Species        n
  &lt;chr&gt;      &lt;int&gt;
1 setosa        50
2 versicolor    50
3 virginica     50</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> <span class="fu">count</span>(Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 x 2
  Species        n
  &lt;chr&gt;      &lt;int&gt;
1 setosa        50
2 versicolor    50
3 virginica     50</code></pre>
</div>
</div>
</section>
<section id="summarize-aggregate-over-entire-columns" class="level1">
<h1>summarize / aggregate over entire column(s)</h1>
<p>If you want to create descriptive statistics for one or more columns in your data frame, you can do the following:</p>
<p>pandas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>iris.agg([<span class="st">'mean'</span>, <span class="st">'min'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Sepal_length  Sepal_width  Petal_length  Petal_width Species
mean      5.843333     3.057333         3.758     1.199333     NaN
min       4.300000     2.000000         1.000     0.100000  setosa

&lt;string&gt;:1: FutureWarning: ['Species'] did not aggregate successfully. If any error is raised this will raise in a future version of pandas. Drop these columns/ops to avoid this warning.</code></pre>
</div>
</div>
<p>dplyr</p>
<p><code>mean()</code> and <code>min()</code> would produce an error if a non-numeric vector is passed to them, so the select_helper <code>where</code> is used to prevent that.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="fu">list</span>(<span class="at">mean =</span> mean, <span class="at">min =</span> min)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 x 8
  Sepal_length_mean Sepal_leng~1 Sepal~2 Sepal~3 Petal~4 Petal~5 Petal~6 Petal~7
              &lt;dbl&gt;        &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1              5.84          4.3    3.06       2    3.76       1    1.20     0.1
# ... with abbreviated variable names 1: Sepal_length_min, 2: Sepal_width_mean,
#   3: Sepal_width_min, 4: Petal_length_mean, 5: Petal_length_min,
#   6: Petal_width_mean, 7: Petal_width_min</code></pre>
</div>
</div>
</section>
<section id="summarize-aggregate-by-group" class="level1">
<h1>summarize / aggregate by group</h1>
<p>If you want to have aggregate statistics for by group in your dataset, you have to use the groupby() method in pandas and the group_by() function in dplyr. You can either do this for all columns or for a specific column:</p>
<p>pandas</p>
<p>Note how pandas uses multilevel indexing for a clean display of the results:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># aggregation by group for all columns</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>iris.groupby([<span class="st">'Species'</span>]).agg([<span class="st">'mean'</span>, <span class="st">'min'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Sepal_length      Sepal_width  ... Petal_length Petal_width     
                   mean  min        mean  ...          min        mean  min
Species                                   ...                              
setosa            5.006  4.3       3.428  ...          1.0       0.246  0.1
versicolor        5.936  4.9       2.770  ...          3.0       1.326  1.0
virginica         6.588  4.9       2.974  ...          4.5       2.026  1.4

[3 rows x 8 columns]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># aggregation by group for a specific column</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>iris.groupby([<span class="st">'Species'</span>]).agg({<span class="st">'Sepal_length'</span>:[<span class="st">'mean'</span>]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Sepal_length
                   mean
Species                
setosa            5.006
versicolor        5.936
virginica         6.588</code></pre>
</div>
</div>
<p>Since dplyr doesn’t support multilevel indexing, the output of the first call looks a little bit messy compared to pandas. The output column names have the form inputColName_aggFunction.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># aggregation by group for all (numeric) columns</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="fu">list</span>(<span class="at">mean =</span> mean, <span class="at">min =</span> min)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 x 9
  Species    Sepal_len~1 Sepal~2 Sepal~3 Sepal~4 Petal~5 Petal~6 Petal~7 Petal~8
  &lt;chr&gt;            &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 setosa            5.01     4.3    3.43     2.3    1.46     1     0.246     0.1
2 versicolor        5.94     4.9    2.77     2      4.26     3     1.33      1  
3 virginica         6.59     4.9    2.97     2.2    5.55     4.5   2.03      1.4
# ... with abbreviated variable names 1: Sepal_length_mean,
#   2: Sepal_length_min, 3: Sepal_width_mean, 4: Sepal_width_min,
#   5: Petal_length_mean, 6: Petal_length_min, 7: Petal_width_mean,
#   8: Petal_width_min</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># aggregation by group for a specific column</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Species) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">mean=</span><span class="fu">mean</span>(Sepal_length))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 x 2
  Species     mean
  &lt;chr&gt;      &lt;dbl&gt;
1 setosa      5.01
2 versicolor  5.94
3 virginica   6.59</code></pre>
</div>
</div>
</section>
<section id="column-math-adding-a-new-column" class="level1">
<h1>column math / adding a new column</h1>
<p>Sometimes you want to create a new column and combine the values of two or more existing columns with some mathematical operation. Here is how to do it in both pandas and dplyr:</p>
<p>pandas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>iris[<span class="st">"New_feature"</span>] <span class="ot">=</span> iris[<span class="st">"Petal_width"</span>] <span class="sc">*</span> iris[<span class="st">"Petal_length"</span>] <span class="sc">/</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>dplyr</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>iris <span class="ot">&lt;-</span> iris <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">New_feature=</span> Petal_width <span class="sc">*</span> Petal_length<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 x 6
  Sepal_length Sepal_width Petal_length Petal_width Species New_feature
         &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;
1          5.1         3.5          1.4         0.2 setosa         0.14
2          4.9         3            1.4         0.2 setosa         0.14
3          4.7         3.2          1.3         0.2 setosa         0.13
4          4.6         3.1          1.5         0.2 setosa         0.15
5          5           3.6          1.4         0.2 setosa         0.14
6          5.4         3.9          1.7         0.4 setosa         0.34</code></pre>
</div>
</div>
</section>
<section id="deleting-columns" class="level1">
<h1>deleting columns</h1>
<p>To clean up a dataframe, deleting columns can sometimes be quite handy:</p>
<p>pandas</p>
<p>In pandas you can delete a column with drop(). You can also use inplace=True to overwrite the current dataframe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ['New_feature'] not found in axis</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>iris.drop(<span class="st">"New_feature"</span>, axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>dplyr</p>
<p>In dplyr you specify the column name you want to remove inside the select() function with a leading minus.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>iris <span class="ot">&lt;-</span> iris <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>New_feature) </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 x 5
  Sepal_length Sepal_width Petal_length Petal_width Species
         &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;  
1          5.1         3.5          1.4         0.2 setosa 
2          4.9         3            1.4         0.2 setosa 
3          4.7         3.2          1.3         0.2 setosa 
4          4.6         3.1          1.5         0.2 setosa 
5          5           3.6          1.4         0.2 setosa 
6          5.4         3.9          1.7         0.4 setosa </code></pre>
</div>
</div>
<p>Sorting records by values</p>
<p>To sort values you can use sort_values() in pandas and arrange() in dplyr. The default sorting for both is ascending. Note the difference in each function call on how to sort descending:</p>
<p>pandas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>iris.sort_values(<span class="st">'Petal_width'</span>, ascending<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Sepal_length  Sepal_width  Petal_length  Petal_width    Species
100           6.3          3.3           6.0          2.5  virginica
109           7.2          3.6           6.1          2.5  virginica
144           6.7          3.3           5.7          2.5  virginica
114           5.8          2.8           5.1          2.4  virginica
140           6.7          3.1           5.6          2.4  virginica
..            ...          ...           ...          ...        ...
12            4.8          3.0           1.4          0.1     setosa
13            4.3          3.0           1.1          0.1     setosa
37            4.9          3.6           1.4          0.1     setosa
32            5.2          4.1           1.5          0.1     setosa
9             4.9          3.1           1.5          0.1     setosa

[150 rows x 5 columns]</code></pre>
</div>
</div>
<p>dplyr</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(Petal_width))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 150 x 5
   Sepal_length Sepal_width Petal_length Petal_width Species  
          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;    
 1          6.3         3.3          6           2.5 virginica
 2          7.2         3.6          6.1         2.5 virginica
 3          6.7         3.3          5.7         2.5 virginica
 4          5.8         2.8          5.1         2.4 virginica
 5          6.3         3.4          5.6         2.4 virginica
 6          6.7         3.1          5.6         2.4 virginica
 7          6.4         3.2          5.3         2.3 virginica
 8          7.7         2.6          6.9         2.3 virginica
 9          6.9         3.2          5.7         2.3 virginica
10          7.7         3            6.1         2.3 virginica
# ... with 140 more rows</code></pre>
</div>
</div>
</section>
<section id="changing-order-of-columns" class="level1">
<h1>changing order of columns</h1>
<p>I don’t use this functionality often, but sometimes it comes in handy if I want to create a table for a presentation and the ordering of the columns doesn’t make logical sense. Here is how to move around columns:</p>
<p>pandas</p>
<p>In Python pandas you need to reindex your columns by making use of a list. Let’s say we want to move the column Species to the front.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>iris.reindex([<span class="st">'Species'</span>,<span class="st">'Petal_length'</span>,<span class="st">'Sepal_length'</span>,<span class="st">'Sepal_width'</span>,<span class="st">'Petal_Width'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Species  Petal_length  Sepal_length  Sepal_width  Petal_Width
0       setosa           1.4           5.1          3.5          NaN
1       setosa           1.4           4.9          3.0          NaN
2       setosa           1.3           4.7          3.2          NaN
3       setosa           1.5           4.6          3.1          NaN
4       setosa           1.4           5.0          3.6          NaN
..         ...           ...           ...          ...          ...
145  virginica           5.2           6.7          3.0          NaN
146  virginica           5.0           6.3          2.5          NaN
147  virginica           5.2           6.5          3.0          NaN
148  virginica           5.4           6.2          3.4          NaN
149  virginica           5.1           5.9          3.0          NaN

[150 rows x 5 columns]</code></pre>
</div>
</div>
<p>dplyr</p>
<p>In dplyr you can use the handy relocate() function. Again let’s say we want to move the column Species to the front.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> <span class="fu">relocate</span>(Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 150 x 5
   Species Sepal_length Sepal_width Petal_length Petal_width
   &lt;chr&gt;          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
 1 setosa           5.1         3.5          1.4         0.2
 2 setosa           4.9         3            1.4         0.2
 3 setosa           4.7         3.2          1.3         0.2
 4 setosa           4.6         3.1          1.5         0.2
 5 setosa           5           3.6          1.4         0.2
 6 setosa           5.4         3.9          1.7         0.4
 7 setosa           4.6         3.4          1.4         0.3
 8 setosa           5           3.4          1.5         0.2
 9 setosa           4.4         2.9          1.4         0.2
10 setosa           4.9         3.1          1.5         0.1
# ... with 140 more rows</code></pre>
</div>
</div>
<p>Note that you can use .before or .after to place a columne before or after another.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> <span class="fu">relocate</span>(Species, <span class="at">.before=</span>Sepal_width)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 150 x 5
   Sepal_length Species Sepal_width Petal_length Petal_width
          &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
 1          5.1 setosa          3.5          1.4         0.2
 2          4.9 setosa          3            1.4         0.2
 3          4.7 setosa          3.2          1.3         0.2
 4          4.6 setosa          3.1          1.5         0.2
 5          5   setosa          3.6          1.4         0.2
 6          5.4 setosa          3.9          1.7         0.4
 7          4.6 setosa          3.4          1.4         0.3
 8          5   setosa          3.4          1.5         0.2
 9          4.4 setosa          2.9          1.4         0.2
10          4.9 setosa          3.1          1.5         0.1
# ... with 140 more rows</code></pre>
</div>
</div>
</section>
<section id="slicing" class="level1">
<h1>slicing</h1>
<p>Slicing is a whole topic on its own and there is a lot of ways on how to do it. Let us step through the most frequently used slicing operation below:</p>
<p>Slicing by row Sometimes you know the exact row number you want to extract. Although the procedure in dplyr and pandas is quite similar please note that Indexing in Python starts at 0 and in R at 1.</p>
<p>pandas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>iris.iloc[[<span class="dv">49</span>,<span class="dv">50</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Sepal_length  Sepal_width  Petal_length  Petal_width     Species
49           5.0          3.3           1.4          0.2      setosa
50           7.0          3.2           4.7          1.4  versicolor</code></pre>
</div>
</div>
<p>dplyr</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">50</span>, <span class="dv">51</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 x 5
  Sepal_length Sepal_width Petal_length Petal_width Species   
         &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;     
1            5         3.3          1.4         0.2 setosa    
2            7         3.2          4.7         1.4 versicolor</code></pre>
</div>
</div>
</section>
<section id="slicing-first-and-last-records-head-tail" class="level1">
<h1>Slicing first and last records (head / tail)</h1>
<p>Sometimes we want to see either the first or last records in a dataframe. This can be either done by providing a fixed number n or a proportion prop of values.</p>
<p>pandas</p>
<p>In pandas you can use the head() or tail() method to get a fixed amount of records. If you want to extraction a proportion, you have to do some math on your own:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># returns 5 records</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>iris.head(n<span class="op">=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sepal_length  Sepal_width  Petal_length  Petal_width Species
0           5.1          3.5           1.4          0.2  setosa
1           4.9          3.0           1.4          0.2  setosa
2           4.7          3.2           1.3          0.2  setosa
3           4.6          3.1           1.5          0.2  setosa
4           5.0          3.6           1.4          0.2  setosa</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># returns the last 10% of total records</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>iris.tail(n <span class="op">=</span> <span class="bu">len</span>(iris) <span class="op">//</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Sepal_length  Sepal_width  Petal_length  Petal_width    Species
135           7.7          3.0           6.1          2.3  virginica
136           6.3          3.4           5.6          2.4  virginica
137           6.4          3.1           5.5          1.8  virginica
138           6.0          3.0           4.8          1.8  virginica
139           6.9          3.1           5.4          2.1  virginica
140           6.7          3.1           5.6          2.4  virginica
141           6.9          3.1           5.1          2.3  virginica
142           5.8          2.7           5.1          1.9  virginica
143           6.8          3.2           5.9          2.3  virginica
144           6.7          3.3           5.7          2.5  virginica
145           6.7          3.0           5.2          2.3  virginica
146           6.3          2.5           5.0          1.9  virginica
147           6.5          3.0           5.2          2.0  virginica
148           6.2          3.4           5.4          2.3  virginica
149           5.9          3.0           5.1          1.8  virginica</code></pre>
</div>
</div>
<p>dplyr</p>
<p>In dplyr there are two designated functions for this use case: slice_head() and slice_tail(). Please note how you can either specify a fixed number or a proportion:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># returns first 5 records</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 x 5
  Sepal_length Sepal_width Petal_length Petal_width Species
         &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;  
1          5.1         3.5          1.4         0.2 setosa 
2          4.9         3            1.4         0.2 setosa 
3          4.7         3.2          1.3         0.2 setosa 
4          4.6         3.1          1.5         0.2 setosa 
5          5           3.6          1.4         0.2 setosa </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># returns the last 10% of total records</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> <span class="fu">slice_tail</span>(<span class="at">prop=</span><span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 x 5
   Sepal_length Sepal_width Petal_length Petal_width Species  
          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;    
 1          7.7         3            6.1         2.3 virginica
 2          6.3         3.4          5.6         2.4 virginica
 3          6.4         3.1          5.5         1.8 virginica
 4          6           3            4.8         1.8 virginica
 5          6.9         3.1          5.4         2.1 virginica
 6          6.7         3.1          5.6         2.4 virginica
 7          6.9         3.1          5.1         2.3 virginica
 8          5.8         2.7          5.1         1.9 virginica
 9          6.8         3.2          5.9         2.3 virginica
10          6.7         3.3          5.7         2.5 virginica
11          6.7         3            5.2         2.3 virginica
12          6.3         2.5          5           1.9 virginica
13          6.5         3            5.2         2   virginica
14          6.2         3.4          5.4         2.3 virginica
15          5.9         3            5.1         1.8 virginica</code></pre>
</div>
</div>
</section>
<section id="creating-boolean-vectorseries" class="level1">
<h1>creating boolean vector/series</h1>
<p>Such vector/series are useful for subsetting a dataframe and creating “dummy” variables analysis</p>
<p>Using inequalities</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (iris.Petal_width &gt; iris.Petal_width.median()).value_counts()</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>iris[<span class="st">"wide_petal"</span>] <span class="op">=</span> iris[<span class="st">"Petal_width"</span>] <span class="op">&gt;</span> iris[<span class="st">"Petal_width"</span>].median()</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>iris[<span class="st">"wide_petal"</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>False    78
True     72
Name: wide_petal, dtype: int64</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>iris <span class="op">=</span> r.iris</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>mpg[<span class="st">"great_mpg"</span>] <span class="op">=</span> (mpg.cty) <span class="op">&gt;</span> <span class="dv">20</span> <span class="op">&amp;</span> (mpg.hwy <span class="op">&gt;</span> <span class="dv">25</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>mpg.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  manufacturer model  displ    year  cyl  ...   cty   hwy  fl    class great_mpg
0         audi    a4    1.8  1999.0  4.0  ...  18.0  29.0   p  compact      True
1         audi    a4    1.8  1999.0  4.0  ...  21.0  29.0   p  compact      True
2         audi    a4    2.0  2008.0  4.0  ...  20.0  31.0   p  compact      True
3         audi    a4    2.0  2008.0  4.0  ...  21.0  30.0   p  compact      True
4         audi    a4    2.8  1999.0  6.0  ...  16.0  26.0   p  compact      True

[5 rows x 12 columns]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>mpg <span class="op">=</span> r.mpg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(iris, <span class="at">wide_petal =</span> Petal_width <span class="sc">&gt;</span> <span class="fu">quantile</span>(Petal_width, <span class="at">probs =</span> <span class="fl">0.50</span>)) <span class="sc">%&gt;%</span> <span class="fu">count</span>(wide_petal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 x 2
  wide_petal     n
  &lt;lgl&gt;      &lt;int&gt;
1 FALSE         78
2 TRUE          72</code></pre>
</div>
</div>
<p>Using regex on a string variable</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>iris.Species.<span class="bu">str</span>.contains(<span class="st">"^vir"</span>, regex <span class="op">=</span> <span class="va">True</span>).value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>False    100
True      50
Name: Species, dtype: int64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(iris, <span class="at">is_vir =</span> <span class="fu">str_detect</span>(Species, <span class="st">"^vir"</span>)) <span class="sc">%&gt;%</span> <span class="fu">count</span>(is_vir)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 x 2
  is_vir     n
  &lt;lgl&gt;  &lt;int&gt;
1 FALSE    100
2 TRUE      50</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>